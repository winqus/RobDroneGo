<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="975px" preserveAspectRatio="none" style="width:1560px;height:975px;background:#FFFFFF;" version="1.1" viewBox="0 0 1560 975" width="1560px" zoomAndPan="magnify"><defs/><g><rect fill="#ADD8E6" height="963.4141" style="stroke:#181818;stroke-width:0.5;" width="1511" x="43.5" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="138" x="730" y="19.4951">Campus Management</text><rect fill="#00FFFF" height="942.0625" style="stroke:#181818;stroke-width:0.5;" width="358" x="43.5" y="27.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="189" x="128" y="40.8467">Framework And Drivers Layer</text><rect fill="#77FFAA" height="942.0625" style="stroke:#181818;stroke-width:0.5;" width="359" x="509.5" y="27.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="156" x="611" y="40.8467">Interface Adapters Layer</text><rect fill="#FF6666" height="942.0625" style="stroke:#181818;stroke-width:0.5;" width="194" x="1086.5" y="27.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="170" x="1098.5" y="40.8467">Application Business Rules</text><rect fill="#EEDDAA" height="942.0625" style="stroke:#181818;stroke-width:0.5;" width="206" x="1348.5" y="27.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="162" x="1370.5" y="40.8467">Enterprise Business Rules</text><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="14" x2="14" y1="80.3125" y2="930.8047"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="79" x2="79" y1="80.3125" y2="930.8047"/><rect fill="#FFFFFF" height="802.1406" style="stroke:#181818;stroke-width:1.0;" width="10" x="74" y="110.6641"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="183" x2="183" y1="80.3125" y2="930.8047"/><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="178" y="232.0703"/><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="178" y="396.8281"/><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="178" y="639.6406"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="326.5" x2="326.5" y1="80.3125" y2="930.8047"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="460.5" x2="460.5" y1="80.3125" y2="930.8047"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="551.5" x2="551.5" y1="80.3125" y2="930.8047"/><rect fill="#FFFFFF" height="741.4375" style="stroke:#181818;stroke-width:1.0;" width="10" x="546.5" y="141.0156"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="659" x2="659" y1="80.3125" y2="930.8047"/><rect fill="#FFFFFF" height="91.0547" style="stroke:#181818;stroke-width:1.0;" width="10" x="654" y="201.7188"/><rect fill="#FFFFFF" height="91.0547" style="stroke:#181818;stroke-width:1.0;" width="10" x="654" y="366.4766"/><rect fill="#FFFFFF" height="91.0547" style="stroke:#181818;stroke-width:1.0;" width="10" x="654" y="609.2891"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="796.5" x2="796.5" y1="80.3125" y2="930.8047"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="925" x2="925" y1="80.3125" y2="930.8047"/><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="920" y="761.0469"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1031" x2="1031" y1="80.3125" y2="930.8047"/><rect fill="#FFFFFF" height="91.0547" style="stroke:#181818;stroke-width:1.0;" width="10" x="1026" y="730.6953"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1183.5" x2="1183.5" y1="80.3125" y2="930.8047"/><rect fill="#FFFFFF" height="680.7344" style="stroke:#181818;stroke-width:1.0;" width="10" x="1178.5" y="171.3672"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1397.5" x2="1397.5" y1="80.3125" y2="930.8047"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1463" x2="1463" y1="80.3125" y2="930.8047"/><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="1458" y="548.5859"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1517" x2="1517" y1="80.3125" y2="930.8047"/><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="1512" y="487.8828"/><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="18" x="5" y="47.7031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="12" y="69.2363"> </text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="63" x="47.5" y="47.7031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="49" x="54.5" y="69.2363">Routing</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="125" x="120.5" y="47.7031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111" x="127.5" y="69.2363">Floor Persistence</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="142" x="255.5" y="47.7031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="128" x="262.5" y="69.2363">Building Persistence</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="86" x="417.5" y="47.7031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="424.5" y="69.2363">Data Model</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="76" x="513.5" y="47.7031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="520.5" y="69.2363">Controller</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="119" x="599.5" y="47.7031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="105" x="606.5" y="69.2363">Floor Repository</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="136" x="728.5" y="47.7031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="122" x="735.5" y="69.2363">Building Repository</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="81" x="884.5" y="47.7031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="67" x="891.5" y="69.2363">Floor DTO</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="99" x="981.5" y="47.7031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85" x="988.5" y="69.2363">Floor Mapper</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="98" x="1134.5" y="47.7031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="1141.5" y="69.2363">Floor Service</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="64" x="1365.5" y="47.7031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50" x="1372.5" y="69.2363">Building</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="47" x="1439.5" y="47.7031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="33" x="1446.5" y="69.2363">Floor</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="41" x="1496.5" y="47.7031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="27" x="1503.5" y="69.2363">Map</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="18" x="5" y="930.8047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="12" y="952.3379"> </text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="63" x="47.5" y="930.8047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="49" x="54.5" y="952.3379">Routing</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="125" x="120.5" y="930.8047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111" x="127.5" y="952.3379">Floor Persistence</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="142" x="255.5" y="930.8047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="128" x="262.5" y="952.3379">Building Persistence</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="86" x="417.5" y="930.8047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="424.5" y="952.3379">Data Model</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="76" x="513.5" y="930.8047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="520.5" y="952.3379">Controller</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="119" x="599.5" y="930.8047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="105" x="606.5" y="952.3379">Floor Repository</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="136" x="728.5" y="930.8047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="122" x="735.5" y="952.3379">Building Repository</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="81" x="884.5" y="930.8047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="67" x="891.5" y="952.3379">Floor DTO</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="99" x="981.5" y="930.8047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85" x="988.5" y="952.3379">Floor Mapper</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="98" x="1134.5" y="930.8047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="1141.5" y="952.3379">Floor Service</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="64" x="1365.5" y="930.8047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50" x="1372.5" y="952.3379">Building</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="47" x="1439.5" y="930.8047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="33" x="1446.5" y="952.3379">Floor</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="41" x="1496.5" y="930.8047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="27" x="1503.5" y="952.3379">Map</text><ellipse cx="10.5" cy="109.9141" fill="none" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="62,106.6641,72,110.6641,62,114.6641,66,110.6641" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="15" x2="68" y1="110.6641" y2="110.6641"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="34" x="18" y="105.8076">Patch</text><polygon fill="#181818" points="534.5,137.0156,544.5,141.0156,534.5,145.0156,538.5,141.0156" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="84" x2="540.5" y1="141.0156" y2="141.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134" x="91" y="136.1592">loadMap(req, res, next)</text><polygon fill="#181818" points="1166.5,167.3672,1176.5,171.3672,1166.5,175.3672,1170.5,171.3672" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="556.5" x2="1172.5" y1="171.3672" y2="171.3672"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="261" x="563.5" y="166.5107">loadMap(buildingCode, floorNumber, mapInfo)</text><polygon fill="#181818" points="675,197.7188,665,201.7188,675,205.7188,671,201.7188" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="669" x2="1177.5" y1="201.7188" y2="201.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148" x="681" y="196.8623">findByCode(buildingCode)</text><polygon fill="#181818" points="199,228.0703,189,232.0703,199,236.0703,195,232.0703" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="193" x2="653" y1="232.0703" y2="232.0703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148" x="205" y="227.2139">findByCode(buildingCode)</text><polygon fill="#181818" points="642,258.4219,652,262.4219,642,266.4219,646,262.4219" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="188" x2="648" y1="262.4219" y2="262.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="44" x="195" y="257.5654">building</text><polygon fill="#181818" points="1166.5,288.7734,1176.5,292.7734,1166.5,296.7734,1170.5,292.7734" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="664" x2="1172.5" y1="292.7734" y2="292.7734"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="44" x="671" y="287.917">building</text><line style="stroke:#181818;stroke-width:1.0;" x1="1188.5" x2="1230.5" y1="323.125" y2="323.125"/><line style="stroke:#181818;stroke-width:1.0;" x1="1230.5" x2="1230.5" y1="323.125" y2="336.125"/><line style="stroke:#181818;stroke-width:1.0;" x1="1189.5" x2="1230.5" y1="336.125" y2="336.125"/><polygon fill="#181818" points="1199.5,332.125,1189.5,336.125,1199.5,340.125,1195.5,336.125" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="195" x="1195.5" y="318.2686">building.floorSize &gt;= mapInfo.size</text><polygon fill="#181818" points="675,362.4766,665,366.4766,675,370.4766,671,366.4766" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="669" x2="1177.5" y1="366.4766" y2="366.4766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="225" x="681" y="361.6201">findByCode(buildingCode, floorNumber)</text><polygon fill="#181818" points="199,392.8281,189,396.8281,199,400.8281,195,396.8281" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="193" x2="653" y1="396.8281" y2="396.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="225" x="205" y="391.9717">findByCode(buildingCode, floorNumber)</text><polygon fill="#181818" points="642,423.1797,652,427.1797,642,431.1797,646,427.1797" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="188" x2="648" y1="427.1797" y2="427.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24" x="195" y="422.3232">floor</text><polygon fill="#181818" points="1166.5,453.5313,1176.5,457.5313,1166.5,461.5313,1170.5,457.5313" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="664" x2="1172.5" y1="457.5313" y2="457.5313"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24" x="671" y="452.6748">floor</text><polygon fill="#181818" points="1500,483.8828,1510,487.8828,1500,491.8828,1504,487.8828" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1188.5" x2="1506" y1="487.8828" y2="487.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="1195.5" y="483.0264">create(mapInfo)</text><polygon fill="#181818" points="1199.5,514.2344,1189.5,518.2344,1199.5,522.2344,1195.5,518.2344" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1193.5" x2="1511" y1="518.2344" y2="518.2344"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="25" x="1205.5" y="513.3779">map</text><polygon fill="#181818" points="1446,544.5859,1456,548.5859,1446,552.5859,1450,548.5859" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1188.5" x2="1452" y1="548.5859" y2="548.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94" x="1195.5" y="543.7295">floor.map = map</text><polygon fill="#181818" points="1199.5,574.9375,1189.5,578.9375,1199.5,582.9375,1195.5,578.9375" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1193.5" x2="1457" y1="578.9375" y2="578.9375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="51" x="1205.5" y="574.0811">Success</text><polygon fill="#181818" points="675,605.2891,665,609.2891,675,613.2891,671,609.2891" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="669" x2="1177.5" y1="609.2891" y2="609.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="58" x="681" y="604.4326">save(floor)</text><polygon fill="#181818" points="199,635.6406,189,639.6406,199,643.6406,195,639.6406" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="193" x2="653" y1="639.6406" y2="639.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="58" x="205" y="634.7842">save(floor)</text><polygon fill="#181818" points="642,665.9922,652,669.9922,642,673.9922,646,669.9922" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="188" x2="648" y1="669.9922" y2="669.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="51" x="195" y="665.1357">Success</text><polygon fill="#181818" points="1166.5,696.3438,1176.5,700.3438,1166.5,704.3438,1170.5,700.3438" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="664" x2="1172.5" y1="700.3438" y2="700.3438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="51" x="671" y="695.4873">Success</text><polygon fill="#181818" points="1047,726.6953,1037,730.6953,1047,734.6953,1043,730.6953" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1041" x2="1177.5" y1="730.6953" y2="730.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69" x="1053" y="725.8389">toDTO(floor)</text><polygon fill="#181818" points="941,757.0469,931,761.0469,941,765.0469,937,761.0469" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="935" x2="1025" y1="761.0469" y2="761.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="72" x="947" y="756.1904">floor as DTO</text><polygon fill="#181818" points="1014,787.3984,1024,791.3984,1014,795.3984,1018,791.3984" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="930" x2="1020" y1="791.3984" y2="791.3984"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50" x="937" y="786.542">floorDTO</text><polygon fill="#181818" points="1166.5,817.75,1176.5,821.75,1166.5,825.75,1170.5,821.75" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1036" x2="1172.5" y1="821.75" y2="821.75"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50" x="1043" y="816.8936">floorDTO</text><polygon fill="#181818" points="567.5,848.1016,557.5,852.1016,567.5,856.1016,563.5,852.1016" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="561.5" x2="1177.5" y1="852.1016" y2="852.1016"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50" x="573.5" y="847.2451">floorDTO</text><polygon fill="#181818" points="95,878.4531,85,882.4531,95,886.4531,91,882.4531" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="89" x2="545.5" y1="882.4531" y2="882.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50" x="101" y="877.5967">floorDTO</text><ellipse cx="10.5" cy="912.0547" fill="none" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="27.5,908.8047,17.5,912.8047,27.5,916.8047,23.5,912.8047" style="stroke:#181818;stroke-width:1.0;"/><ellipse cx="73.5" cy="912.0547" fill="none" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="25.5" x2="69" y1="912.8047" y2="912.8047"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50" x="28" y="907.9482">floorDTO</text><!--MD5=[c5fb76b98dbced461dcfdfa54fbd2e8e]
@startuml SD Lv3

!pragma teoz true

participant " "
box "Campus Management" #LightBlue

    box "Framework And Drivers Layer" #00ffff
        participant Routing
        participant "Floor Persistence" as FloorPers
        participant "Building Persistence" as BuildingPers
    end box

    participant "Data Model" as Data
    box "Interface Adapters Layer" #77ffaa
        participant Controller
        participant "Floor Repository" as FloorRepo
        participant "Building Repository" as BuildingRepo
    end box

    participant "Floor DTO" as FloorDTO
    participant "Floor Mapper" as FloorMapper
    box "Application Business Rules" #ff6666
        participant "Floor Service" as FloorService
    end box

    box "Enterprise Business Rules" #eeddaa
        participant Building
        participant Floor
        participant Map
    end box
end box


[o-> Routing : Patch 
activate Routing

    Routing -> Controller : loadMap(req, res, next)
    activate Controller

        Controller -> FloorService : loadMap(buildingCode, floorNumber, mapInfo)
        activate FloorService

            FloorService -> FloorRepo : findByCode(buildingCode)
            activate FloorRepo

                FloorRepo -> FloorPers : findByCode(buildingCode)
                activate FloorPers

                FloorPers - -> FloorRepo : building
                deactivate FloorPers

            FloorRepo - -> FloorService : building
            deactivate FloorRepo

            FloorService -> FloorService : building.floorSize >= mapInfo.size

            FloorService -> FloorRepo : findByCode(buildingCode, floorNumber)
            activate FloorRepo

                FloorRepo -> FloorPers : findByCode(buildingCode, floorNumber)
                activate FloorPers

                FloorPers - -> FloorRepo : floor
                deactivate FloorPers

            FloorRepo - -> FloorService : floor
            deactivate FloorRepo


            FloorService -> Map: create(mapInfo)
            activate Map

            Map - -> FloorService : map
            deactivate Map

            FloorService -> Floor : floor.map = map
            activate Floor

            Floor - -> FloorService : Success
            deactivate Floor

            FloorService -> FloorRepo : save(floor)
            activate FloorRepo

                FloorRepo -> FloorPers : save(floor)
                activate FloorPers

                FloorPers - -> FloorRepo : Success
                deactivate FloorPers

            FloorRepo - -> FloorService : Success
            deactivate FloorRepo

            FloorService - -> FloorMapper : toDTO(floor)
            activate FloorMapper

                FloorMapper -> FloorDTO : floor as DTO
                activate FloorDTO

                FloorDTO - -> FloorMapper : floorDTO
                deactivate FloorDTO

            FloorMapper - -> FloorService : floorDTO
            deactivate FloorMapper

        FloorService - -> Controller : floorDTO
        deactivate FloorService

    Controller - -> Routing : floorDTO
    deactivate Controller

[o<- -o Routing : floorDTO
deactivate Routing


@enduml

PlantUML version 1.2022.7(Mon Aug 22 18:01:30 BST 2022)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: Cp1252
Language: pt
Country: PT
--></g></svg>